# Samsung Galaxy 배터리 최적화 완전 해제 가이드

## 🔴 현재 상황 (2026-01-13 00:15 기준)

```
🔋 배터리 최적화: 활성화됨 (위험) ❌
⚠️ 메모리 경고: 13회 (UI_HIDDEN)
📱 프로세스 우선순위: SERVICE (정상이지만 배터리 최적화로 인해 CACHED로 강등될 위험)
```

**사용자가 배터리 최적화를 껐다고 생각하지만, 로그에는 여전히 "활성화됨 (위험)"으로 기록되어 있습니다.**

---

## 🎯 Samsung Galaxy의 5단계 배터리 최적화 시스템

Samsung은 일반 Android와 달리 **5개의 독립적인 최적화 설정**이 있습니다.
**하나만 끄는 것으로는 부족합니다. 5개 모두 확인해야 합니다.**

---

## ✅ 1단계: 배터리 최적화 제외 (Battery Optimization Whitelist)

### 경로:
```
설정 → 앱 → Vortex → 배터리 → 배터리 사용량 최적화
```

### 확인 방법:
1. 설정 앱 열기
2. "앱" 선택
3. "Vortex" 찾기
4. "배터리" 메뉴 선택
5. "배터리 사용량 최적화" 또는 "배터리 최적화" 선택
6. 상단 드롭다운에서 **"모두"** 선택 (기본값은 "최적화 안 함"이므로 Vortex가 안 보일 수 있음)
7. Vortex를 찾아서 **OFF (최적화 안 함)** 로 설정

### 예상 화면:
```
○ 최적화 (권장)         ← 이것이 선택되어 있으면 문제!
● 최적화 안 함          ← 반드시 이것을 선택!
```

---

## 🔥 2단계: 절전 앱 목록에서 제거 (가장 중요!)

### 경로:
```
설정 → 배터리 및 디바이스 케어 → 배터리 → 백그라운드 사용 제한
```

### 확인 방법:
1. 설정 → 배터리 및 디바이스 케어
2. 배터리 선택
3. 하단의 "백그라운드 사용 제한" 선택
4. **"절전 앱"** 탭 확인
   - Vortex가 여기 있으면 **반드시 제거!**
5. **"깊은 절전 앱"** 탭 확인
   - Vortex가 여기 있으면 **반드시 제거!**

### ⚠️ 중요:
Samsung은 사용자가 모르게 앱을 "절전 앱" 목록에 자동으로 추가합니다!
**이것이 가장 흔한 원인입니다.**

---

## 🎛️ 3단계: 자동 최적화 끄기

### 경로:
```
설정 → 배터리 및 디바이스 케어 → 배터리 → 백그라운드 사용 제한 → ⋮ (우측 상단)
```

### 확인 방법:
1. 2단계의 "백그라운드 사용 제한" 화면에서
2. 우측 상단의 **⋮ (점 3개)** 메뉴 선택
3. "자동 최적화" 또는 "사용하지 않는 앱 절전" **OFF**

### 설명:
이 옵션이 켜져 있으면 Samsung이 3일간 사용하지 않은 앱을 자동으로 "절전 앱"에 추가합니다.
Vortex는 백그라운드로만 실행되므로 Samsung이 "사용하지 않음"으로 판단할 수 있습니다.

---

## 📡 4단계: 백그라운드 데이터 제한 해제

### 경로:
```
설정 → 앱 → Vortex → 모바일 데이터
```

### 확인 방법:
1. 설정 → 앱 → Vortex
2. "모바일 데이터" 선택
3. **"백그라운드 데이터 허용"** ON
4. **"데이터 무제한 사용"** ON (선택사항이지만 권장)

---

## 🔐 5단계: 개발자 옵션 - Standby Bucket 확인

### 경로 (개발자 옵션이 활성화된 경우):
```
설정 → 개발자 옵션 → Standby Apps
```

### 확인 방법:
1. 개발자 옵션이 활성화되어 있다면
2. "Standby Apps" 또는 "대기 앱" 메뉴
3. Vortex를 찾아서 **"Active"** 또는 **"활성"** 상태인지 확인
4. "Rare" 또는 "Restricted"면 문제!

### ADB로 확인 (고급):
```bash
adb shell am get-standby-bucket com.example.twinme
```
- 출력이 `5` 또는 `10`이면 정상
- `30` (RARE) 또는 `40` (RESTRICTED)이면 문제

---

## 🔍 설정 후 확인 방법

### 방법 1: 스크립트로 확인 (권장)
```bash
node scripts/verify_battery_settings.js
```

### 기대 결과:
```
✅ UI_HIDDEN 이벤트 없음 - 설정 성공!
✅ 배터리 최적화가 제대로 제외되었습니다
```

### 방법 2: 10분간 실제 사용 후 로그 확인
1. Vortex 앱 시작
2. 10분간 방치 (다른 앱 사용 OK)
3. 다시 스크립트 실행

---

## 📊 문제가 계속되면 확인할 사항

### 1. 재부팅 후 재확인
Samsung은 재부팅 후 일부 설정이 초기화될 수 있습니다.
재부팅 후 위 5단계를 다시 확인하세요.

### 2. OneUI 버전 확인
```
설정 → 휴대전화 정보 → 소프트웨어 정보 → OneUI 버전
```

OneUI 6.0 이상은 추가적인 최적화 옵션이 있을 수 있습니다.

### 3. Good Guardians 앱 확인
Samsung의 "Good Guardians" 앱이 설치되어 있다면:
- Battery Guardian 모듈 확인
- Vortex가 제한 목록에 없는지 확인

---

## 🎯 핵심 체크리스트

설정 완료 후 아래 모든 항목이 ✅ 여야 합니다:

- [ ] 1단계: 배터리 최적화 → **최적화 안 함**
- [ ] 2단계: 절전 앱 목록 → **Vortex 없음**
- [ ] 2단계: 깊은 절전 앱 목록 → **Vortex 없음**
- [ ] 3단계: 자동 최적화 → **OFF**
- [ ] 4단계: 백그라운드 데이터 → **허용**
- [ ] 5단계: Standby Bucket → **Active (5 또는 10)**

---

## 💡 왜 이렇게 복잡한가?

Samsung Galaxy는 배터리 수명을 극대화하기 위해 일반 Android보다 훨씬 공격적인 최적화를 사용합니다.

**일반 Android:**
- 배터리 최적화 1개

**Samsung Galaxy:**
- 배터리 최적화 whitelist
- 절전 앱 목록 (자동 추가!)
- 깊은 절전 앱 목록
- 자동 최적화 (3일 미사용 시 자동 추가)
- Standby Bucket (App Standby)

**하나라도 놓치면 앱이 강제 종료됩니다.**

---

## 🚀 다음 단계

1. 위 5단계를 모두 확인하고 설정
2. `node scripts/verify_battery_settings.js` 실행
3. 10분간 실제 사용 후 다시 스크립트 실행
4. 여전히 문제가 있다면:
   - `node scripts/check_errors.js` 실행해서 로그 확인
   - 배터리 최적화 상태가 "무시됨 (안전)"으로 변경되었는지 확인

---

## 📞 문제 해결이 안 되면

위 모든 단계를 수행했는데도 로그에 "활성화됨 (위험)"이 표시되면:
1. 휴대폰 재부팅
2. Vortex 앱 재설치
3. 위 5단계 다시 확인
4. ADB로 직접 확인:
   ```bash
   adb shell dumpsys deviceidle whitelist | findstr com.example.twinme
   ```
